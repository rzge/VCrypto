{% extends 'main/layout.html' %}

{% block title %}Результат поиска{% endblock %}
{% load extras %}
{% block content %}
    <div class="feauture">
        <form action="{% url 'search_results' %}" method="get">
            <input type="text" name="query" placeholder="Введите username">
            <button type="submit">Search</button>
        </form>
        <h1>Результат поиска по запросу "{{ query }}"</h1>
        <ul>
            {% for result in results %}
                {% if user.id != result.id %}
                    <div class="alert alert-info">
                        {% get_friend_requests_receiver as friend_requests_receiver %}
                        {% get_friend_requests_sender as friend_requests_sender %}
                        {% for sender in user.sender.all %}
                            <li><p>{{sender.sender.id}}</p></li> {# Объекты получателей #}
                        {% endfor %}
                        <li><p>{{friend_requests_receiver}}</p></li>
                        <li><p>{{friend_requests_sender}}</p></li>
                        {# Снизу основная логика #}
                        <li><p>username пользователя: {{ result.username }}. Его ID: {{ result.id }}</p></li>
                        {% if result not in user.friends.all and result.id not in friend_requests_receiver %}
                            <a href="{% url 'send_friend_request' result.id %}" class="btn btn-success">добавить</a>
                        {% endif %}
                        {% if result not in user.friends.all and result.id in friend_requests_receiver %}
                            <a href="{% url 'cancel_friend_request' result.id %}" class="btn btn-warning">отправлено</a>
                        {% endif %}
                    </div>
                {% endif %}
            {% empty %}
                <li>No results found.</li>
            {% endfor %}
        </ul>
    </div>
{% endblock %}